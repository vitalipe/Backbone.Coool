/*! Backbone.Coool - v0.1.0 [7471545d7f6af770c355e2f14072989b642dda11] - 2015-07-15 */
!function(a,b){"function"==typeof define&&define.amd?define(["underscore","Backbone"],b):"object"==typeof exports?b(require("underscore"),require("Backbone")):b(a._,a.Backbone)}(this,function(a,b){"use strict";!function(a){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=a();else if("function"==typeof define&&define.amd)define([],a);else{var b;b="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this,b.Coool=a()}}(function(){return function c(a,b,d){function e(g,h){if(!b[g]){if(!a[g]){var i="function"==typeof require&&require;if(!h&&i)return i(g,!0);if(f)return f(g,!0);var j=new Error("Cannot find module '"+g+"'");throw j.code="MODULE_NOT_FOUND",j}var k=b[g]={exports:{}};a[g][0].call(k.exports,function(b){var c=a[g][1][b];return e(c?c:b)},k,k.exports,c,a,b,d)}return b[g].exports}for(var f="function"==typeof require&&require,g=0;g<d.length;g++)e(d[g]);return e}({1:[function(b,c,d){var e=b("./Class"),f=b("./traits/Properties"),g=e.extend({traits:[f],"default":void 0,properties:{model:{get:function(){if(!this.__model)throw new Error("Looks like there is no model for this attribute, did you forget to call _super() from initialize ?");return this.__model}},name:{get:function(){if(!this.__name)throw new Error("Looks like there is no name for this attribute, did you forget to call _super() from initialize ?");return this.__name}}},constructor:function(a){return this instanceof g==!1?this.extend(a||{}):this._super.apply(this,arguments)},initialize:function(a,b){this.__model=a,this.__name=b},triggerChangeEvent:function(a){var b=this.model;b.trigger("change",b),b.trigger("change:"+this.name,b,a)},get:function(){return a.has(this.model.attributes,this.name)?this.model.attributes[this.name]:this["default"]},set:function(a,b){b=b||{};var c=!b.silent&&!this.isEqualTo(a);this.model.attributes[this.name]=a,c&&this.triggerChangeEvent(a)},parse:function(a){return a},toJSON:function(){return this.get()},isEqualTo:function(b){return a.isEqual(this.get(),b)}},{defaultValue:function(){return this.prototype["default"]},defaultsTo:function(a){return this.extend({"default":a})}});c.exports=g},{"./Class":2,"./traits/Properties":13}],2:[function(a,b,c){var d=a("./extend"),e=function(){this.initialize&&this.initialize.apply(this,arguments)};e.extend=d,b.exports=e},{"./extend":8}],3:[function(a,c,d){var e=a("./extend"),f=b.Collection.extend({});f.extend=e,c.exports=f},{"./extend":8}],4:[function(a,b,c){var d={Properties:a("./traits/Properties"),AttributeProperties:a("./traits/AttributeProperties"),InheritanceHelpers:a("./traits/InheritanceHelpers"),AttributeGuard:a("./traits/AttributeGuard"),Relations:a("./traits/Relations")},e={EnumValue:a("./types/EnumValue"),Boolean:a("./types/Boolean"),Number:a("./types/Number"),String:a("./types/String"),Tuple:a("./types/Tuple"),ModelReference:a("./types/ModelReference"),ModelArrayReference:a("./types/ModelArrayReference")};b.exports={Class:a("./Class"),Model:a("./Model"),Collection:a("./Collection"),Attribute:a("./Attribute"),_deps:a("./_deps"),extend:a("./extend"),traits:d,type:e}},{"./Attribute":1,"./Class":2,"./Collection":3,"./Model":5,"./_deps":6,"./extend":8,"./traits/AttributeGuard":10,"./traits/AttributeProperties":11,"./traits/InheritanceHelpers":12,"./traits/Properties":13,"./traits/Relations":14,"./types/Boolean":15,"./types/EnumValue":16,"./types/ModelArrayReference":17,"./types/ModelReference":18,"./types/Number":19,"./types/String":20,"./types/Tuple":21}],5:[function(c,d,e){var f=c("./extend"),g=c("./Attribute"),h=c("./_util"),i=b.Model.extend({});i.extend=f;var j=function(a){return h.isAncestor(g,a)},k={"static":{extend:function(b){b.__customAttrClasses=a.extend({},this.prototype.__customAttrClasses),b.defaults=a.extend({},a(this.prototype).result("defaults"),a(b).result("defaults")),a.each(b.defaults,function(a,c){j(a)&&(b.__customAttrClasses[c]=a,b.defaults[c]=a.defaultValue())})}}};d.exports=i.extend({traits:[k],initialize:function(){this.__customAttrs={},a(this.__customAttrClasses).each(function(a,b){this.__customAttrs[b]=new a(this,b)},this)},get:function(a){var b=this.__customAttrs[a];return b?b.get():this._super(a)},set:function(b,c,d){var e={},f=this;return a.isObject(b)?(e=a.clone(b),d=c):e[b]=c,a.chain(this.__customAttrs).pick(a.keys(e)).each(function(a,b){a.set(e[b],d),f.attributes[b]=e[b],delete e[b]}),this._super.call(this,e,d)},parse:function(b){var c=this._super.call(this,b);return a.each(this.__customAttrs,function(d,e){a.has(b,e)&&(c[e]=d.parse(b[e]))}),c},toJSON:function(){var b=this._super.call(this);return a.each(this.__customAttrs,function(a,c){b[c]=a.toJSON()}),b}})},{"./Attribute":1,"./_util":7,"./extend":8}],6:[function(a,c,d){c.exports={extend:b.Model.extend,mixin:a("./lib/Cocktail.js").mixin}},{"./lib/Cocktail.js":9}],7:[function(b,c,d){var e=function(b,c){return a.isFunction(c)?a.isUndefined(c.__parent__)?!1:c.__parent__===b?!0:e(b,c.__parent__):!1};c.exports={isAncestor:e}},{}],8:[function(b,c,d){var e=b("./_deps"),f=b("./_util"),g=function(b,c){return a.extend.apply(a,[b].concat(c))},h=function(b,c){return a.chain(b).pluck(c).compact().value()},i=function(b){return a.chain(b).pluck("static").compact().value()},j=function(b){return a.chain(b).map(function(b){return a.omit(b,"static")}).compact().value()},k=function(b,c){var d=a.methods(b);a.each(d,function(a){var d=b[a],e=c[a]||function(){};b[a]=function(){if(!this)return d.apply(this,arguments);var a,b=this._super;return this._super=e,a=d.apply(this,arguments),this._super=b,a}})},l=function(b,c,d,e){var f=function(a){a.call(b,c,d)},g=h(e,"extend"),i=b.__extendMixins||[];a.each(i,f),a.each(g,f),d.__extendMixins=a.union(i,g)};c.exports=function(b,c){var d,h,m=(b.traits||[]).map(a.clone),n=i(m),o=j(m),p=this;return c=c||{},c=g(c,n),delete c.extend,l(this,b,c,n),k(b,this.prototype),a.has(b,"constructor")?(h=b.constructor,b.constructor=function(){return h.apply(this instanceof d||f.isAncestor(d,this)?this:d,arguments)}):b.constructor=function(){return p.apply(this instanceof d||f.isAncestor(d,this)?this:d,arguments)},c.__parent__=p,d=e.extend.call(this,b,c),e.mixin(d,o),d}},{"./_deps":6,"./_util":7}],9:[function(b,c,d){
//!     (c) 2012 Onsi Fakhouri
//!     Cocktail.js may be freely distributed under the MIT license.
//!     http://github.com/onsi/cocktail
var e={};e.mixins={},e.mixin=function(b){var c=a.chain(arguments).toArray().rest().flatten().value(),d=b.prototype||b,f={};return a.each(c,function(b){a.isString(b)&&(b=e.mixins[b]),a.each(b,function(b,c){if(a.isFunction(b)){if(d[c]===b)return;d[c]&&(f[c]=f.hasOwnProperty(c)?f[c]:[d[c]],f[c].push(b)),d[c]=b}else a.isArray(b)?d[c]=a.union(b,d[c]||[]):a.isObject(b)?d[c]=a.extend({},b,d[c]||{}):c in d||(d[c]=b)})}),a.each(f,function(b,c){d[c]=function(){var c,d=this,e=arguments;return a.each(b,function(b){var f=a.isFunction(b)?b.apply(d,e):b;c="undefined"==typeof f?c:f}),c}}),b};var f;e.patch=function(b){f=b.Model.extend;var c=function(a,b){var c=f.call(this,a,b),d=c.prototype.mixins;return d&&c.prototype.hasOwnProperty("mixins")&&e.mixin(c,d),c};a.each([b.Model,b.Collection,b.Router,b.View],function(b){b.mixin=function(){e.mixin(this,a.toArray(arguments))},b.extend=c})},e.unpatch=function(b){a.each([b.Model,b.Collection,b.Router,b.View],function(a){a.mixin=void 0,a.extend=f})},c.exports=e},{}],10:[function(b,c,d){var e=function(b,c){return c===b.idAttribute||a.has(b.defaults,c)};c.exports={set:function(b,c){var d={},f=this;a.isObject(b)?d=a.clone(b):d[b]=c,a.each(d,function(a,b){if(!e(f,b))throw new Error("Model Error: called set() with unknown key name: '"+b+"', a typo? ")},this)},get:function(a){if(!e(this,a))throw new Error("Model Error: called get() with unknown key name: '"+a+"', a typo? ")}}},{}],11:[function(b,c,d){c.exports={initialize:function(){var b={},c=this;a.each(a(c).result("defaults"),function(d,e){a.has(c,e)||(b[e]={get:a.partial(c.get,e),set:a.partial(c.set,e)})}),Object.defineProperties(this,b)}}},{}],12:[function(a,b,c){var d=a("../_util");b.exports={"static":{isAncestorOf:function(a){return d.isAncestor(this,a)}}}},{"../_util":7}],13:[function(b,c,d){c.exports={"static":{extend:function(b){var c=this.prototype;c.properties&&(b.properties=a.extend({},c.properties,b.properties))}},initialize:function(){var b=this.properties||{};a(b).each(function(b){a.defaults(b,{configurable:!0})}),Object.defineProperties(this,b)}}},{}],14:[function(b,c,d){var e=b("../types/ModelReference"),f=b("../types/ModelArrayReference"),g=null,h=function(b){if(!a.isObject(g))throw new Error("can't find store, make sure setStore() was called...");if(!g[b])throw new Error("can't resolve relation, no such collection: "+b);return g[b]};c.exports={"static":{setStore:function(a){g=a},hasOneFrom:function(a){return e.extend({resolveRef:function(b){var c=h(a);return c.get(b)||null}})},hasMany:function(b){return f.extend({resolveRef:function(c){if(a.isEmpty(c))return[];var d=h(b);return a.compact(c.map(function(a){return d.get(a)}))}})}}}},{"../types/ModelArrayReference":17,"../types/ModelReference":18}],15:[function(b,c,d){var e=b("../Attribute");c.exports=e.extend({"default":!1,parse:function(b){return a.isString(b)?(b=b.toLowerCase(),"true"===b||"1"===b):Boolean(b)},set:function(b,c){if(!a.isBoolean(b))throw new Error('Attempting to set() an invalid value: "'+b+'" on: '+this.model.cid+":"+this.name);return this._super(b,c)}})},{"../Attribute":1}],16:[function(b,c,d){var e=b("../Attribute");c.exports=e.extend({"enum":{},valueAttribute:"value",parse:function(b){var c=this.valueAttribute;return a.find(this["enum"],function(a){return b===a[c]||b===a})},set:function(b,c){return a.contains(this["enum"],b)?this._super(b,c):void 0},toJSON:function(){var b=this.valueAttribute,c=this.get();return a.has(c,b)?c[b]:c}})},{"../Attribute":1}],17:[function(b,c,d){var e=b("../Attribute");c.exports=e.extend({"default":[],get:function(){return this.resolveRef(this._super())},set:function(b,c){var d=[],e=this.model.cid,f=this.name;return b.forEach(function(b){if(b=a.has(b,"id")?b.id:b,a.isObject(b))throw new Error('Attempting to set() an invalid value: "'+b+'" on: '+e+":"+f);d.push(b)}),this._super(d,c)},isEqualTo:function(b){return b=b.map(function(b){return a.has(b,"id")?b.id:b}),a.isEqual(e.prototype.get.call(this),b)},toJSON:function(){return e.prototype.get.call(this)}})},{"../Attribute":1}],18:[function(b,c,d){var e=b("../Attribute");c.exports=e.extend({"default":null,resolveRef:function(a){throw new Error("Not Implemented!")},get:function(){return this.resolveRef(this._super())},set:function(b,c){if(a.has(b,"id")&&(b=b.id),a.isObject(b))throw new Error('Attempting to set() an invalid value: "'+b+'" on: '+this.model.cid+":"+this.name);return this._super(b,c)},isEqualTo:function(b){return a.has(b,"id")&&(b=b.id),a.isEqual(e.prototype.get.call(this),b)},toJSON:function(){return e.prototype.get.call(this)}})},{"../Attribute":1}],19:[function(b,c,d){var e=b("../Attribute"),f=function(a,b,c){return Math.min(Math.max(c,a),b)};c.exports=e.extend({"default":0,min:Number.NEGATIVE_INFINITY,max:Number.POSITIVE_INFINITY,alwaysClamp:!1,parse:function(b){return a.isString(b)||a.isNumber(b)?f(this.min,this.max,Number(b)):NaN},set:function(b,c){if(!a.isNumber(b))throw new Error('Attempting to set() an invalid value: "'+b+'" on: '+this.model.cid+":"+this.name);return this.alwaysClamp&&(b=f(this.min,this.max,b)),this._super(b,c)},toJSON:function(a){return f(this.min,this.max,this._super(a))}})},{"../Attribute":1}],20:[function(b,c,d){var e=b("../Attribute");c.exports=e.extend({"default":"",parse:function(a){return String(a)},set:function(b,c){if(!a.isString(b))throw new Error('Attempting to set() an invalid value: "'+b+'" on: '+this.model.cid+":"+this.name);return this._super(b,c)}})},{"../Attribute":1}],21:[function(b,c,d){var e=b("../Attribute"),f=Object.freeze([]);c.exports=e.extend({"default":f,initialize:function(){this._super.apply(this,arguments),Object.isFrozen(this["default"])===!1&&(this["default"]=Object.freeze(this["default"]))},set:function(b,c){if(!a.isArray(b))throw new Error('Attempting to set() an invalid value: "'+b+'" on: '+this.model.cid+":"+this.name);return Object.isFrozen(b)||(b=Object.freeze(a.clone(b))),this._super(b,c)},parse:function(b){if(a.isString(b))try{b=JSON.parse(b)}catch(c){b=null}return a.isArray(b)?Object.freeze(b):f}})},{"../Attribute":1}]},{},[4])(4)})});